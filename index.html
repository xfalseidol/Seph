<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>From: Uncle Steve, Anarchy's Archivist</title>
    <style>
        /* General Body Styling */
        body {
            background-color: #1a1a1a;
            color: #d1d1d1;
            font-family: 'Courier New', Courier, monospace;
            margin: 0;
            padding: 2em;
            line-height: 1.8;
        }

        /* Header and Controls Styling */
        .header {
            text-align: center;
            border-bottom: 2px dashed #444;
            padding-bottom: 1.5em;
            margin-bottom: 2em;
        }
        .header h1 {
            color: #00ff41; /* A classic terminal green */
            font-size: 2.5em;
            margin: 0;
            letter-spacing: 2px;
            text-shadow: 0 0 5px #00ff41;
        }
        .header p {
            color: #888;
            margin: 0.5em 0 0 0;
        }
        .controls {
            margin-top: 1.5em;
            display: flex;
            justify-content: center;
            gap: 1em;
            align-items: center;
        }
        /* Styling for Buttons and Inputs */
        button, input[type="text"] {
            background-color: #2a2a2a;
            border: 1px solid #444;
            color: #d1d1d1;
            font-family: inherit;
            padding: 10px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        button:hover {
            background-color: #00ff41;
            color: #1a1a1a;
            border-color: #00ff41;
        }
        input[type="text"] {
            width: 300px;
            outline: none;
        }
        input[type="text"]:focus {
            border-color: #00ff41;
            box-shadow: 0 0 8px rgba(0, 255, 65, 0.5);
        }

        /* Non-standard Columnar Layout */
        #story-container {
            column-count: 4; /* Number of columns */
            column-gap: 2em;   /* Space between columns */
            column-rule: 1px dashed #444; /* Dividing line */
            text-align: justify;
            transition: all 0.5s ease-in-out;
        }

        /* Individual Text Fragments */
        .text-fragment {
            background-color: #222;
            border: 1px solid #333;
            padding: 1em;
            margin-bottom: 1.5em;
            break-inside: avoid-column; /* Prevents fragments from breaking across columns */
            transition: all 0.3s ease;
            opacity: 0.7; /* Default state */
        }
        
        /* Highlighted/Filtered State */
        .text-fragment.highlight {
            background-color: rgba(0, 255, 65, 0.1);
            border-color: #00ff41;
            transform: scale(1.02);
            opacity: 1.0;
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.3);
        }
        
        /* Hidden Message Styling */
        #secret-message {
            display: none; /* Hidden by default */
            background-color: #111;
            border: 1px solid #00ff41;
            padding: 1.5em;
            margin: 0 auto 2em auto;
            max-width: 80%;
            text-align: center;
            color: #00ff41;
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.7);
        }

        /* Responsive design for smaller screens */
        @media (max-width: 1200px) {
            #story-container { column-count: 3; }
        }
        @media (max-width: 900px) {
            #story-container { column-count: 2; }
        }
        @media (max-width: 600px) {
            #story-container { column-count: 1; }
            .controls { flex-direction: column; }
        }

    </style>
</head>
<body>

    <div class="header">
        <h1>The Ghost in the Suburb</h1>
        <p>A Metatextual Puzzle for Persephone</p>
        <p>From: Uncle Steve, Anarchy's Archivist</p>
        <div class="controls">
            <button id="shuffle-btn">Shuffle Context</button>
            <input type="text" id="filter-input" placeholder="Filter by Keyword...">
        </div>
    </div>
    
    <div id="secret-message">
        <p><strong>[ENCRYPTED MESSAGE DECODED]</strong></p>
        <p>Seph,</p>
        <p>Well done. Concepts are keys. This one unlocked my note to you. But a concept is not the story. The story is always closer to home. The most important words are often the simplest ones. Find the true 'ghost'. Find the heart of the story.</p>
        <p>- Steve</p>
    </div>

    <div id="story-container">
        </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const storyText = `Persephone sat hunched over her notebook, the pen in her hand as inert as her imagination. She felt like a ghost haunting her own life, every thought and every word a secondhand echo.||She had heard a tale once, in a coffee shop, about a writer consumed by the search for an original story, one that was truly his own. Persephone had taken up this story as her own quest, believing that by charting another’s journey, she could finally find her way home.||This search for authenticity was the engine of her narrative, but all she produced were pale imitations and cross-outs. The protagonist of Persephone's story was her godfather, Steven Jacob, a solitary man in a rented room, surrounded by the ghosts of his own failed narratives.||Steven Jacob’s life was a mirrored tragedy of Persephone's own frustrations, a canvas onto which she projected her deepest fears. She wrote about Uncle Steve's desk, its surface scarred with the history of his fruitless attempts.||Like Persephone, he was consumed by a single, desperate idea: to find a story so visceral it felt like a memory, a part of his own being. He began writing a simple tale about a man and the ghosts that haunted his suburb, built around a recurring dream of an impossible image: a street corner with two cars from different eras parked side-by-side.||Uncle Steve wrote about the cars, a black Chevrolet Tahoe and a silver Chevrolet Suburban, parked in an impossible configuration. He described the strange temporal paradox they created, a subtle warping of light and reality.||The cars were not just objects; they were the "ghost in the suburb," symbolic objects that represented the past and future collapsing into a single moment. He felt an overwhelming urge to place a figure in this scene, a man standing on the street corner, a presence so significant it felt like a linchpin holding the world together.||Seph's hand stilled. The details of the story she was writing—Uncle Steve's story—had become too familiar. They were no longer fictional constructs but fragments of her own forgotten past.||She reached for an old shoebox, its contents filled with the faded memories of her childhood. Sifting through the photographs, her fingers trembled as they found it: a small, corrupted photo from a family album. It showed a younger version of her father standing on a street corner.||The image was a fractal, a geometric pattern that folded in on itself. As she looked closer, the details solidified into a waking nightmare. There they were, the black Tahoe and the silver Suburban, parked side-by-side in that same impossible configuration.||The "ghost in the suburb" was not a fictional character from her godfather's story; it was her own father. Her mind processed this visual trigger as a Mnemopolous Ekpyrotic Concept.||The image was a non-Euclidean space where the smallest ripple—the details of the two cars—caused a temporal resonance cascade that was distorting her entire landscape. Seph realized her father was the true "ghost" that had kept her world in line.||The photograph was her terminal condition. She no longer needed to write or create; she had found the story she'd been searching for all along, not in the act of creation, but in a simple, tangible object from her past.||The memory of her father's presence in that photograph was her Book of Life, the one she had been so desperately trying to write. She held the photograph, the recursive loop finally broken.`;
            
            const container = document.getElementById('story-container');
            const filterInput = document.getElementById('filter-input');
            const shuffleBtn = document.getElementById('shuffle-btn');
            const secretMessage = document.getElementById('secret-message');

            let fragments = [];

            // 1. Initialize: Split the story into fragments and display them
            function initializeStory() {
                fragments = storyText.split('||').map(text => {
                    const p = document.createElement('p');
                    p.className = 'text-fragment';
                    p.textContent = text.trim();
                    container.appendChild(p);
                    return p;
                });
            }

            // 2. Shuffle Function: Randomly reorder the fragments in the container
            function shuffleFragments() {
                // Fisher-Yates shuffle algorithm
                for (let i = container.children.length; i >= 0; i--) {
                    container.appendChild(container.children[Math.random() * i | 0]);
                }
            }
            
            // 3. Filter Function: Highlight fragments based on keyword
            function filterFragments() {
                const searchTerm = filterInput.value.toLowerCase().trim();
                
                // Secret trigger phrase
                const secretPhrase = "mnemopolous ekpyrotic concept";
                if (searchTerm === secretPhrase) {
                    secretMessage.style.display = 'block';
                } else {
                    secretMessage.style.display = 'none';
                }

                fragments.forEach(fragment => {
                    const text = fragment.textContent.toLowerCase();
                    if (searchTerm && text.includes(searchTerm)) {
                        fragment.classList.add('highlight');
                    } else {
                        fragment.classList.remove('highlight');
                    }
                });

                // Reset all opacity if search is cleared
                if (!searchTerm) {
                    fragments.forEach(f => f.style.opacity = '0.7');
                } else {
                    // Dim non-highlighted fragments
                    fragments.forEach(f => {
                         if(f.classList.contains('highlight')) {
                             f.style.opacity = '1.0';
                         } else {
                             f.style.opacity = '0.3';
                         }
                    });
                }
            }

            // Event Listeners
            shuffleBtn.addEventListener('click', shuffleFragments);
            filterInput.addEventListener('input', filterFragments);

            // Initial setup
            initializeStory();
        });
    </script>

</body>
</html>

